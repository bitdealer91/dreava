{"version":3,"file":"sharedBufferWorker-BI1Z8M5Y-DobD4AUJ.js","sources":["../../assets/sharedBufferWorker-BI1Z8M5Y.js"],"sourcesContent":["class e{constructor(){this.worker=null;this.initialized=!1;this.bufferSize=1048576;this.init()}async init(){try{if(\"undefined\"!=typeof SharedArrayBuffer){this.worker=new Worker(\"/workers/shared-buffer-worker.js\");this.worker.onmessage=this.handleMessage.bind(this);this.worker.onerror=this.handleError.bind(this);this.initialized=!0;console.log(\"‚úÖ Shared Buffer Worker initialized\")}else console.warn(\"‚ö†Ô∏è SharedArrayBuffer not supported\")}catch(e){console.warn(\"‚ö†Ô∏è Shared Buffer Worker initialization failed:\",e)}}handleMessage(e){const{type:r,data:s,id:t}=e.data;switch(r){case\"PROCESSING_COMPLETE\":console.log(\"‚úÖ Shared buffer processing complete:\",s);break;case\"PROCESSING_PROGRESS\":console.log(\"üìä Shared buffer progress:\",s);break;case\"ERROR\":console.error(\"‚ùå Shared buffer error:\",s);break;default:console.log(\"üì® Shared buffer message:\",r,s)}}handleError(e){console.error(\"‚ùå Shared Buffer Worker error:\",e)}async processFiles(e){if(!this.initialized){console.warn(\"‚ö†Ô∏è Shared Buffer Worker not available, using fallback\");return await this.fallbackProcessing(e)}return new Promise((r,s)=>{const t=Date.now();const o=setTimeout(()=>{console.error(\"‚è∞ Shared buffer processing timeout\");s(new Error(\"Processing timeout\"))},3e4);const messageHandler=e=>{const{type:a,data:n,id:i}=e.data;if(i===t){clearTimeout(o);this.worker.removeEventListener(\"message\",messageHandler);\"PROCESSING_COMPLETE\"===a?r(n):\"ERROR\"===a&&s(new Error(n))}};this.worker.addEventListener(\"message\",messageHandler);const a=e.map(e=>{const r=new SharedArrayBuffer(this.bufferSize);return{file:e,buffer:r}});this.worker.postMessage({type:\"PROCESS_FILES\",data:{files:a},id:t})})}async fallbackProcessing(e){console.log(\"üîÑ Using fallback processing for files:\",e.length);const r=[];for(const t of e)try{const e=await this.processFileFallback(t);r.push(e)}catch(s){console.error(\"‚ùå Fallback processing failed for file:\",t.name,s);r.push({error:s.message})}return r}async processFileFallback(e){return new Promise(r=>{const s=new FileReader;s.onload=s=>{const t=s.target.result;const o=new Uint8Array(t);let a=0;for(let e=0;e<o.length;e++)a+=o[e];r({file:e.name,size:e.size,checksum:a,processed:!0})};s.onerror=()=>{r({file:e.name,error:\"File reading failed\",processed:!1})};s.readAsArrayBuffer(e)})}async compressData(e){return this.initialized?new Promise((r,s)=>{const t=Date.now();const o=setTimeout(()=>{console.error(\"‚è∞ Compression timeout\");s(new Error(\"Compression timeout\"))},1e4);const messageHandler=e=>{const{type:a,data:n,id:i}=e.data;if(i===t){clearTimeout(o);this.worker.removeEventListener(\"message\",messageHandler);\"COMPRESSION_COMPLETE\"===a?r(n):\"ERROR\"===a&&s(new Error(n))}};this.worker.addEventListener(\"message\",messageHandler);this.worker.postMessage({type:\"COMPRESS_DATA\",data:{data:e},id:t})}):await this.fallbackCompression(e)}async fallbackCompression(e){try{const r=new CompressionStream(\"gzip\");const s=r.writable.getWriter();const t=r.readable.getReader();const o=new Uint8Array(e);s.write(o);s.close();const a=[];for(;;){const{done:e,value:r}=await t.read();if(e)break;a.push(r)}const n=new Uint8Array(a.reduce((e,r)=>e+r.length,0));let i=0;for(const e of a){n.set(e,i);i+=e.length}return n.buffer}catch(r){console.warn(\"‚ö†Ô∏è Fallback compression failed:\",r);return e}}async decompressData(e){return this.initialized?new Promise((r,s)=>{const t=Date.now();const o=setTimeout(()=>{console.error(\"‚è∞ Decompression timeout\");s(new Error(\"Decompression timeout\"))},1e4);const messageHandler=e=>{const{type:a,data:n,id:i}=e.data;if(i===t){clearTimeout(o);this.worker.removeEventListener(\"message\",messageHandler);\"DECOMPRESSION_COMPLETE\"===a?r(n):\"ERROR\"===a&&s(new Error(n))}};this.worker.addEventListener(\"message\",messageHandler);this.worker.postMessage({type:\"DECOMPRESS_DATA\",data:{data:e},id:t})}):await this.fallbackDecompression(e)}async fallbackDecompression(e){try{const r=new DecompressionStream(\"gzip\");const s=r.writable.getWriter();const t=r.readable.getReader();const o=new Uint8Array(e);s.write(o);s.close();const a=[];for(;;){const{done:e,value:r}=await t.read();if(e)break;a.push(r)}const n=new Uint8Array(a.reduce((e,r)=>e+r.length,0));let i=0;for(const e of a){n.set(e,i);i+=e.length}return n.buffer}catch(r){console.warn(\"‚ö†Ô∏è Fallback decompression failed:\",r);return e}}destroy(){if(this.worker){this.worker.terminate();this.worker=null}this.initialized=!1}}export{e as SharedBufferWorker};\n//# sourceMappingURL=sharedBufferWorker-BI1Z8M5Y.js.map\n"],"names":["e","constructor","this","worker","initialized","bufferSize","init","SharedArrayBuffer","Worker","onmessage","handleMessage","bind","onerror","handleError","console","log","warn","type","r","data","s","id","t","error","processFiles","fallbackProcessing","Promise","Date","now","o","setTimeout","Error","messageHandler","a","n","i","clearTimeout","removeEventListener","addEventListener","map","file","buffer","postMessage","files","length","processFileFallback","push","name","message","FileReader","onload","target","result","Uint8Array","size","checksum","processed","readAsArrayBuffer","compressData","fallbackCompression","CompressionStream","writable","getWriter","readable","getReader","write","close","done","value","read","reduce","set","decompressData","fallbackDecompression","DecompressionStream","destroy","terminate"],"mappings":"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"}