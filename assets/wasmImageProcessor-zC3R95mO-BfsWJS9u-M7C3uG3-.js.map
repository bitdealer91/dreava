{"version":3,"file":"wasmImageProcessor-zC3R95mO-BfsWJS9u-M7C3uG3-.js","sources":["../../assets/wasmImageProcessor-zC3R95mO-BfsWJS9u.js"],"sourcesContent":["class y{constructor(){this.wasmModule=null,this.wasmLoaded=!1,this.canvasProcessor=null,this.initCanvasProcessor()}async initCanvasProcessor(){this.canvasProcessor=new f,console.log(\"‚úÖ Canvas image processor initialized as fallback\")}async loadWasm(){try{const e=\"/wasm/image-processor.wasm\";(await fetch(e,{method:\"HEAD\"})).ok?(this.wasmModule=await WebAssembly.instantiateStreaming(fetch(e)),this.wasmLoaded=!0,console.log(\"‚úÖ WASM image processor loaded successfully\")):console.warn(\"‚ö†Ô∏è WASM file not found, using Canvas fallback\")}catch(e){console.warn(\"‚ö†Ô∏è WASM loading failed, using Canvas fallback:\",e)}}async optimize(e,a=.8){if(this.wasmLoaded&&this.wasmModule)try{return await this.wasmOptimize(e,a)}catch{console.warn(\"‚ö†Ô∏è WASM optimization failed, falling back to Canvas\")}return await this.canvasOptimize(e,a)}async wasmOptimize(e,a){return await this.canvasOptimize(e,a)}async canvasOptimize(e,a){return new Promise(m=>{const i=document.createElement(\"canvas\"),s=i.getContext(\"2d\"),c=new Image;c.onload=()=>{let{width:o,height:t}=c;if(o>1200||t>900){const n=Math.min(1200/o,900/t);o*=n,t*=n}i.width=o,i.height=t,s.imageSmoothingEnabled=!0,s.imageSmoothingQuality=\"high\",s.drawImage(c,0,0,o,t),i.toBlob(n=>{const r=new File([n],e.name,{type:e.type,lastModified:Date.now()});console.log(`üì± Canvas optimization: ${e.size} -> ${r.size} bytes`),m(r)},e.type,a)},c.onerror=()=>{console.warn(\"‚ö†Ô∏è Image loading failed, returning original file\"),m(e)},c.src=URL.createObjectURL(e)})}async resizeImage(e,a,m){return await this.canvasOptimize(e,1,{maxWidth:a,maxHeight:m})}async compressImage(e,a){return await this.canvasOptimize(e,a)}async convertFormat(e,a){return await this.canvasOptimize(e,.9,{format:a})}}class f{constructor(){this.supportedFormats=[\"image/jpeg\",\"image/png\",\"image/webp\"]}async optimize(e,a=.8,m={}){const{maxWidth:i,maxHeight:s,format:c}=m;return new Promise(o=>{const t=document.createElement(\"canvas\"),n=t.getContext(\"2d\"),r=new Image;r.onload=()=>{let{width:l,height:g}=r;if(i&&l>i){const d=i/l;l=i,g*=d}if(s&&g>s){const d=s/g;g=s,l*=d}t.width=l,t.height=g,n.imageSmoothingEnabled=!0,n.imageSmoothingQuality=\"high\",n.drawImage(r,0,0,l,g);const w=c||e.type,u=this.supportedFormats.includes(w)?w:\"image/jpeg\";t.toBlob(d=>{const h=new File([d],e.name,{type:u,lastModified:Date.now()});console.log(`üì± Canvas optimization: ${e.size} -> ${h.size} bytes (${Math.round((1-h.size/e.size)*100)}% reduction)`),o(h)},u,a)},r.onerror=()=>{console.warn(\"‚ö†Ô∏è Image loading failed, returning original file\"),o(e)},r.src=URL.createObjectURL(e)})}}export{y as WasmImageProcessor};\n//# sourceMappingURL=wasmImageProcessor-zC3R95mO-BfsWJS9u.js.map\n"],"names":["e","a","o","n"],"mappings":"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"}