{"version":3,"file":"wasmImageProcessor-zC3R95mO-BfsWJS9u.js","sources":["../../assets/wasmImageProcessor-zC3R95mO.js"],"sourcesContent":["class y{constructor(){this.wasmModule=null,this.wasmLoaded=!1,this.canvasProcessor=null,this.initCanvasProcessor()}async initCanvasProcessor(){this.canvasProcessor=new z,console.log(\"‚úÖ Canvas image processor initialized as fallback\")}async loadWasm(){try{const a=\"/wasm/image-processor.wasm\";(await fetch(a,{method:\"HEAD\"})).ok?(this.wasmModule=await WebAssembly.instantiateStreaming(fetch(a)),this.wasmLoaded=!0,console.log(\"‚úÖ WASM image processor loaded successfully\")):console.warn(\"‚ö†Ô∏è WASM file not found, using Canvas fallback\")}catch(a){console.warn(\"‚ö†Ô∏è WASM loading failed, using Canvas fallback:\",a)}}async optimize(a,t=.8){if(this.wasmLoaded&&this.wasmModule)try{return await this.wasmOptimize(a,t)}catch{console.warn(\"‚ö†Ô∏è WASM optimization failed, falling back to Canvas\")}return await this.canvasOptimize(a,t)}async wasmOptimize(a,t){return await this.canvasOptimize(a,t)}async canvasOptimize(a,t){return new Promise(c=>{const i=document.createElement(\"canvas\"),r=i.getContext(\"2d\"),m=new Image;m.onload=()=>{let{width:o,height:e}=m;if(o>1200||e>900){const s=Math.min(1200/o,900/e);o*=s,e*=s}i.width=o,i.height=e,r.imageSmoothingEnabled=!0,r.imageSmoothingQuality=\"high\",r.drawImage(m,0,0,o,e),i.toBlob(s=>{const n=new File([s],a.name,{type:a.type,lastModified:Date.now()});console.log(`üì± Canvas optimization: ${a.size} -> ${n.size} bytes`),c(n)},a.type,t)},m.onerror=()=>{console.warn(\"‚ö†Ô∏è Image loading failed, returning original file\"),c(a)},m.src=URL.createObjectURL(a)})}async resizeImage(a,t,c){return await this.canvasOptimize(a,1,{maxWidth:t,maxHeight:c})}async compressImage(a,t){return await this.canvasOptimize(a,t)}async convertFormat(a,t){return await this.canvasOptimize(a,.9,{format:t})}}class z{constructor(){this.supportedFormats=[\"image/jpeg\",\"image/png\",\"image/webp\"]}async optimize(a,t=.8,c={}){const{maxWidth:i,maxHeight:r,format:m}=c;return new Promise(h=>{const g=document.createElement(\"canvas\"),o=g.getContext(\"2d\"),e=new Image;e.onload=()=>{let{width:s,height:n}=e;if(i&&s>i){const l=i/s;s=i,n*=l}if(r&&n>r){const l=r/n;n=r,s*=l}g.width=s,g.height=n,o.imageSmoothingEnabled=!0,o.imageSmoothingQuality=\"high\",o.drawImage(e,0,0,s,n);const w=m||a.type,p=this.supportedFormats.includes(w)?w:\"image/jpeg\";g.toBlob(l=>{const d=new File([l],a.name,{type:p,lastModified:Date.now()});console.log(`üì± Canvas optimization: ${a.size} -> ${d.size} bytes (${Math.round((1-d.size/a.size)*100)}% reduction)`),h(d)},p,t)},e.onerror=()=>{console.warn(\"‚ö†Ô∏è Image loading failed, returning original file\"),h(a)},e.src=URL.createObjectURL(a)})}}export{y as WasmImageProcessor};\n//# sourceMappingURL=wasmImageProcessor-zC3R95mO.js.map\n"],"names":["z","a","t","c","r","m","e","s","n","h","g","o","l","p","d"],"mappings":"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"}