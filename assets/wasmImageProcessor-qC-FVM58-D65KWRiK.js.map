{"version":3,"file":"wasmImageProcessor-qC-FVM58-D65KWRiK.js","sources":["../../assets/wasmImageProcessor-qC-FVM58.js"],"sourcesContent":["class a{constructor(){this.wasmModule=null;this.wasmLoaded=!1;this.canvasProcessor=null;this.initCanvasProcessor()}async initCanvasProcessor(){this.canvasProcessor=new e;console.log(\"‚úÖ Canvas image processor initialized as fallback\")}async loadWasm(){try{const a=\"/wasm/image-processor.wasm\";const e=await fetch(a,{method:\"HEAD\"});if(e.ok){this.wasmModule=await WebAssembly.instantiateStreaming(fetch(a));this.wasmLoaded=!0;console.log(\"‚úÖ WASM image processor loaded successfully\")}else console.warn(\"‚ö†Ô∏è WASM file not found, using Canvas fallback\")}catch(a){console.warn(\"‚ö†Ô∏è WASM loading failed, using Canvas fallback:\",a)}}async optimize(a,e=.8){if(this.wasmLoaded&&this.wasmModule)try{return await this.wasmOptimize(a,e)}catch(t){console.warn(\"‚ö†Ô∏è WASM optimization failed, falling back to Canvas\")}return await this.canvasOptimize(a,e)}async wasmOptimize(a,e){return await this.canvasOptimize(a,e)}async canvasOptimize(a,e){return new Promise(t=>{const i=document.createElement(\"canvas\");const s=i.getContext(\"2d\");const n=new Image;n.onload=()=>{const o=1200;const c=900;let{width:r,height:m}=n;if(r>o||m>c){const a=Math.min(o/r,c/m);r*=a;m*=a}i.width=r;i.height=m;s.imageSmoothingEnabled=!0;s.imageSmoothingQuality=\"high\";s.drawImage(n,0,0,r,m);i.toBlob(e=>{const i=new File([e],a.name,{type:a.type,lastModified:Date.now()});console.log(`üì± Canvas optimization: ${a.size} -> ${i.size} bytes`);t(i)},a.type,e)};n.onerror=()=>{console.warn(\"‚ö†Ô∏è Image loading failed, returning original file\");t(a)};n.src=URL.createObjectURL(a)})}async resizeImage(a,e,t){return await this.canvasOptimize(a,1,{maxWidth:e,maxHeight:t})}async compressImage(a,e){return await this.canvasOptimize(a,e)}async convertFormat(a,e){return await this.canvasOptimize(a,.9,{format:e})}}class e{constructor(){this.supportedFormats=[\"image/jpeg\",\"image/png\",\"image/webp\"]}async optimize(a,e=.8,t={}){const{maxWidth:i,maxHeight:s,format:n}=t;return new Promise(t=>{const o=document.createElement(\"canvas\");const c=o.getContext(\"2d\");const r=new Image;r.onload=()=>{let{width:m,height:l}=r;if(i&&m>i){const a=i/m;m=i;l*=a}if(s&&l>s){const a=s/l;l=s;m*=a}o.width=m;o.height=l;c.imageSmoothingEnabled=!0;c.imageSmoothingQuality=\"high\";c.drawImage(r,0,0,m,l);const g=n||a.type;const h=this.supportedFormats.includes(g)?g:\"image/jpeg\";o.toBlob(e=>{const i=new File([e],a.name,{type:h,lastModified:Date.now()});console.log(`üì± Canvas optimization: ${a.size} -> ${i.size} bytes (${Math.round(100*(1-i.size/a.size))}% reduction)`);t(i)},h,e)};r.onerror=()=>{console.warn(\"‚ö†Ô∏è Image loading failed, returning original file\");t(a)};r.src=URL.createObjectURL(a)})}}export{a as WasmImageProcessor};\n//# sourceMappingURL=wasmImageProcessor-qC-FVM58.js.map\n"],"names":["a","constructor","this","wasmModule","wasmLoaded","canvasProcessor","initCanvasProcessor","e","console","log","loadWasm","fetch","method","ok","WebAssembly","instantiateStreaming","warn","optimize","wasmOptimize","t","canvasOptimize","Promise","i","document","createElement","s","getContext","n","Image","onload","o","c","width","r","height","m","Math","min","imageSmoothingEnabled","imageSmoothingQuality","drawImage","toBlob","File","name","type","lastModified","Date","now","size","onerror","src","URL","createObjectURL","resizeImage","maxWidth","maxHeight","compressImage","convertFormat","format","supportedFormats","l","g","h","includes","round"],"mappings":"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"}